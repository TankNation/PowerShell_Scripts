#############################################################################################################################################
###~ Hyper-V - Snapshot Restore (SteadyState) ###############################################################################################
#
#~ Brian Tancredi
#~ Created: 2016-11-09
#~ Modified: 2016-11-09
#
#~ References:
#~ http://www.altaro.com/hyper-v/use-powershell-search-checkpoints/
#
#############################################################################################################################################

#############################################################################################################################################
###~ Search for Template VM's with "DND" Snapshots / Restore and Nuke #######################################################################
#############################################################################################################################################

#~ Import Hyper-V Modules
Import-Module Hyper-V

#~ Define Variables
$vmNameSearch = "template"
$ssNameSearch = "DND"

#~ Search Snapshots by vmName and ssName, pass to Restore
Get-VMSnapshot -vmname *$vmNameSearch* -Name *$ssNameSearch* | Restore-VMSnapshot -Confirm:$false
Get-VMSnapshot -vmname *$vmNameSearch* | Where-Object { $_.Name -notlike "*$ssNameSearch*"} | Remove-VMSnapshot -Confirm:$false

#############################################################################################################################################
#~ END ######################################################################################################################################
#############################################################################################################################################
 